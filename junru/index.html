<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Escape Minecraft</title>
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <video playinsline autoplay muted id="cin1">
      <source src="./vid/1cin.mov" type="video/mp4" />
    </video>
    <div id="hintBook" onClick="hints()"></div>
    <img src="./img/invBridge/indices.png" id="hints" />
    <video playinsline muted id="cin2">
      <source src="./vid/2cin.mp4" type="video/mp4" />
    </video>

    <div id="z">z</div>
    <div id="c">c</div>
    <div id="x">x</div>

    <div id="chest1" onClick="chest(1, 'apple.gif', 'bow.png')"></div>
    <div id="chest2" onClick="chest(2, 'chicken.png', 'feather.png')"></div>
    <div id="chest3" onClick="chest(3, 'fire.png', 'gunpowder.png')"></div>
    <div id="chest4" onClick="chest(4, 'ink.png', 'lava.png')"></div>
    <div id="chest5" onClick="chest(5, 'minecart.png', 'paper.png')"></div>
    <div id="chest6" onClick="chest(6, 'hoe.png', 'pearl.png')"></div>
    <div id="chest7" onClick="chest7()"></div>
    <div id="chest8" onClick="chest(8, 'rocket.png', 'star.gif')"></div>
    <div id="chest9" onClick="chest(9, 'stew.png', 'totem.png')"></div>
    <div
      id="chest10"
      onClick="chest(10, 'bucket.png', 'chestplate.png');"
    ></div>

    <div id="chestItem"></div>

    <div id="key" onClick="theKey()"></div>

    <div id="hand" onClick="keyOnHand()"></div>
    <div id="inHand" onClick="unlock()"></div>
    <div id="keyHole" onClick="freedom()"></div>

    <video playinsline muted id="cin3">
      <source src="./vid/3cin.mp4" type="video/mp4" />
    </video>

    <div id="black"></div>

    <script>
      document.addEventListener('keydown', keyboard);
      setTimeout(elimVid, 8000);
      function elimVid() {
        document.getElementById('cin1').style.display = 'none';
        findHints();
      }
      function findHints() {
        document.body.style.backgroundImage =
          'url("./img/invBridge/findHints.png")';
        document.getElementById('hintBook').style.display = 'block';
        console.log('1. Clicker sur le livre.');
      }
      function hints() {
        var book = new Audio();
        book.src = './sounds/open_book.mp3';
        book.play();
        document.getElementById('hintBook').style.display = 'none';
        document.getElementById('hints').style.display = 'block';
        setTimeout(invPath, 1000);
        console.log(
          '2. Suivre les instructions en utilisant les touches correspondantes du clavier.',
        );
        console.log(
          '3. Si vous mourrez, vous allez être transporté vers le début du pont invisible.',
        );
      }

      function keyboard(e) {
        e.preventDefault();
        if (e.keyCode == 87) {
          checkStep('w');
        }
        if (e.keyCode == 65) {
          checkStep('a');
        }
        if (e.keyCode == 68) {
          checkStep('d');
        }
        if (e.keyCode == 90) {
          changeChest('z');
        }
        if (e.keyCode == 88) {
          changeChest('x');
        }
        if (e.keyCode == 67) {
          changeChest('c');
        }
      }
      var steps = [
        'w',
        'w',
        'w',
        'd',
        'w',
        'w',
        'w',
        'a',
        'w',
        'w',
        'd',
        'w',
        'a',
        'w',
        'w',
        'w',
        'a',
        'w',
        'd',
        'w',
      ];
      let chestArray = [
        'chest1',
        'chest2',
        'chest3',
        'chest4',
        'chest5',
        'chest6',
        'chest7',
        'chest8',
        'chest9',
        'chest10',
      ];
      var currentStepIndex = 0;
      var whichRoom = 0;
      function invPath() {
        document.body.style.backgroundImage = 'url("./img/invBridge/0.png")';
      }
      function checkStep(key) {
        if (key === steps[currentStepIndex]) {
          if (currentStepIndex <= steps.length) {
            var move = new Audio('./sounds/hit4.mp3');
            move.play();
            currentStepIndex++;
            document.body.style.backgroundImage = `url(./img/invBridge/${currentStepIndex}.png)`;
            if (currentStepIndex == steps.length) {
              document.getElementById('hints').style.display = 'none';
              setTimeout(playVid(), 500);
              currentStepIndex = -10;
              whichRoom = 1;
              steps = [];
            }
          }
        } else {
          if (whichRoom === 0) {
            var burn = new Audio();
            burn.src = './sounds/fire.mp3';
            burn.play();

            document.body.style.backgroundImage = 'url("./img/inLava/1.png")';
            setTimeout(function () {
              document.body.style.backgroundImage = 'url("./img/inLava/2.png")';
            }, 200);
            setTimeout(function () {
              document.body.style.backgroundImage = 'url("./img/inLava/3.png")';
            }, 400);
            setTimeout(function () {
              document.body.style.backgroundImage = 'url("./img/inLava/4.png")';
            }, 600);
            setTimeout(function () {
              document.body.style.backgroundImage = 'url("./img/inLava/5.png")';
            }, 800);
            setTimeout(function () {
              document.body.style.backgroundImage = 'url("./img/inLava/6.png")';
            }, 1000);
            setTimeout(function () {
              document.body.style.backgroundImage = 'url("./img/inLava/7.png")';
            }, 1200);
            setTimeout(function () {
              document.body.style.backgroundImage = 'url("./img/inLava/8.png")';
            }, 1400);
            setTimeout(function () {
              document.body.style.backgroundImage = 'url("./img/inLava/9.png")';
            }, 1600);
            setTimeout(function () {
              document.body.style.backgroundImage =
                'url("./img/inLava/10.png")';
            }, 1800);

            setTimeout(function () {
              document.body.style.backgroundImage =
                'url("./img/invBridge/0.png")';
            }, 2000);
            setTimeout((currentStepIndex = 0), 2000);
            currentStepIndex = 0;
          }
        }
      }
      var vid = document.getElementById('cin2');

      function playVid() {
        var door = new Audio();
        door.src = './sounds/door_open.mp3';
        door.play();
        document.getElementById('cin2').style.display = 'block';
        vid.play();
        setTimeout(function () {
          document.getElementById('cin2').style.display = 'none';
        }, 10000);
        document.body.style.backgroundImage =
          'url("./img/coffres/coffresMid.png")';
        document.getElementById('z').style.display = 'block';
        document.getElementById('c').style.display = 'block';
        document.getElementById('hand').style.display = 'block';
        console.log(
          '4. Peser sur Z pour aller à gauche et sur C pour aller à droite',
        );
        console.log(
          "5. Clicker sur les coffres et attendre que l'item disparaisse pour clicker sur un autre coffre. Le but est de trouver la clé.",
        );
      }
      var chestSide = 0;
      function changeChest(key) {
        if (key === 'z') {
          document.body.style.backgroundImage =
            'url("./img/coffres/coffresGauche.png")';
          chestArray.forEach(function (chest) {
            document.getElementById(chest).style.display = 'block';
          });
          document.getElementById('z').style.display = 'none';
          document.getElementById('c').style.display = 'block';
          chestSide = 1;
        }
        if (key === 'c') {
          document.body.style.backgroundImage =
            'url("./img/coffres/coffresDroite.png")';
          chestArray.forEach(function (chest) {
            document.getElementById(chest).style.display = 'block';
          });
          document.getElementById('c').style.display = 'none';
          document.getElementById('z').style.display = 'block';

          chestSide = 2;
        }
        if (key === 'x') {
          document.body.style.backgroundImage =
            'url("./img/coffres/coffresMid.png")';
          chestArray.forEach(function (chest) {
            document.getElementById(chest).style.display = 'none';
          });
          document.getElementById('z').style.display = 'block';
          document.getElementById('c').style.display = 'block';
          chestSide = 0;
        }
      }

      function chest(chestNumber, imgide1, imgide2) {
        if (chestSide === 1) {
          var chest = new Audio('./sounds/open_chest.mp3');
          chest.play();
          document.getElementById('chestItem').style.display = 'block';
          document.getElementById(
            'chestItem',
          ).style.backgroundImage = `url("./img/chestItems/${imgide1}")`;
          setTimeout(function () {
            document.getElementById('chestItem').style.backgroundImage = 'none';
          }, 2000);
        }
        if (chestSide === 2) {
          var chest = new Audio('./sounds/open_chest.mp3');
          chest.play();
          document.getElementById('chestItem').style.display = 'block';
          document.getElementById(
            'chestItem',
          ).style.backgroundImage = `url("./img/chestItems/${imgide2}")`;
          setTimeout(function () {
            document.getElementById('chestItem').style.backgroundImage = 'none';
          }, 2000);
        }
        if (chestSide === 0) {
        }
      }
      function chest7() {
        if (chestSide === 1) {
          var chest = new Audio('./sounds/open_chest.mp3');
          chest.play();
          document.getElementById('chestItem').style.display = 'block';
          document.getElementById('chestItem').style.backgroundImage =
            'url("./img/chestItems/potato.png")';
          setTimeout(function () {
            document.getElementById('chestItem').style.backgroundImage = 'none';
          }, 2000);
        }
        if (chestSide === 2) {
          var chest = new Audio('./sounds/open_chest.mp3');
          chest.play();
          document.getElementById('key').style.display = 'block';
          document.getElementById('key').style.backgroundImage =
            'url("./img/chestItems/key.png")';
          setTimeout(function () {
            document.getElementById('key').style.backgroundImage = 'none';
          }, 5000);
          console.log(
            '6. Quand vous trouvez la clé, clicker dessus, elle sera votre curseur, et la déposer sur la main en clickant dessus.',
          );
        }
        if (chestSide === 0) {
        }
      }

      function theKey() {
        var key = new Audio();
        key.src = './sounds/icechime.mp3';
        key.play();

        document.body.style.cursor =
          'url("./img/chestItems/keyCursor.png"),auto';
        chestArray.forEach(function (chest) {
          document.getElementById(chest).style.cursor =
            'url("./img/chestItems/keyCursor.png"),auto';
        });
        document.getElementById('key').style.display = 'none';
        document.getElementById('chest7').style.display = 'none';
        document.getElementById('id').style.pointerEvents = 'auto';
      }
      function keyOnHand() {
        document.body.style.cursor = 'auto';
        document.getElementById('inHand').style.display = 'block';
        chestArray.forEach(function (chest) {
          document.getElementById(chest).style.cursor = 'auto';
        });
        setTimeout(door(), 1000);
      }
      function door() {
        chestArray.forEach(function (chest) {
          document.getElementById(chest).style.display = 'none';
        });
        document.getElementById('z').style.display = 'none';
        document.getElementById('c').style.display = 'none';
        document.body.style.backgroundImage =
          'url("./img/coffres/coffresMidPorte.png")';
        document.getElementById('keyHole').style.display = 'block';
        console.log(
          '7. Si vous flottiez votre pointer au dessus de la poignée de la porte, le curseur deviendra un cadenas.',
        );
        console.log(
          '8. Prendre la clé em clickant dessus, le curseur se changera en clé, et clicker sur le cadenas.',
        );
      }
      function unlock() {
        document.body.style.cursor =
          'url("./img/chestItems/keyCursor.png"), auto';
        document.getElementById('inHand').style.display = 'none';
      }

      var vid2 = document.getElementById('cin3');

      function freedom() {
        var unlock = new Audio('./sounds/open4.mp3');
        unlock.play();
        document.body.style.cursor = 'auto';
        document.getElementById('cin3').style.display = 'block';
        vid2.play();
        setTimeout(function () {
          document.getElementById('black').style.display = 'block';
        }, 7000);
        setTimeout(function () {
          window.parent.nextPerson();
        }, 8000);
      }
    </script>
  </body>
</html>
