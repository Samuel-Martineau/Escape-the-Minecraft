<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Escape Minecraft</title>
    <style>
      #bypass {
        position: absolute;
        left: 2%;
        bottom: 2%;
        width: 2.5%;
        height: 4%;
        background-color: white;
      }
      #cin1 {
        display: fixed;
        position: fixed;
        right: 0;
        bottom: 0;
        width: 100%;
        height: 100%;
        opacity: 100;
      }
      body {
        background-image: none;
        background-size: cover;
      }
      #hintBook {
        display: none;
        width: 3%;
        height: 5%;
        position: absolute;
        left: 56%;
        top: 43%;
      }
      #hints {
        display: none;
        width: 20%;
        image-rendering: pixelated;
        image-rendering: -moz-crisp-edges;
        image-rendering: crisp-edges;
      }
      #cin2 {
        display: none;
        position: fixed;
        right: 0;
        bottom: 0;
        width: 100%;
        height: 100%;
        opacity: 100;
      }
      #chest1 {
        display: none;
        width: 11%;
        height: 6%;
        position: absolute;
        left: 18%;
        top: 41%;
        background-color: white;
      }
      #chest2 {
        display: none;
        width: 9%;
        height: 6%;
        position: absolute;
        left: 32%;
        top: 41%;
        background-color: white;
      }
      #chest3 {
        display: none;
        width: 8%;
        height: 6%;
        position: absolute;
        left: 46%;
        top: 41%;
        background-color: white;
      }
      #chest4 {
        display: none;
        width: 9%;
        height: 6%;
        position: absolute;
        left: 59%;
        top: 41%;
        background-color: white;
      }
      #chest5 {
        display: none;
        width: 11%;
        height: 6%;
        position: absolute;
        left: 71%;
        top: 41%;
        background-color: white;
      }
      #chest6 {
        display: none;
        width: 11%;
        height: 6%;
        position: absolute;
        left: 18%;
        top: 57%;
        background-color: white;
      }
      #chest7 {
        display: none;
        width: 9%;
        height: 6%;
        position: absolute;
        left: 32%;
        top: 57%;
        background-color: white;
      }
      #chest8 {
        display: none;
        width: 8%;
        height: 6%;
        position: absolute;
        left: 46%;
        top: 57%;
        background-color: white;
      }
      #chest9 {
        display: none;
        width: 9%;
        height: 6%;
        position: absolute;
        left: 59%;
        top: 57%;
        background-color: white;
      }
      #chest10 {
        display: none;
        width: 11%;
        height: 6%;
        position: absolute;
        left: 71%;
        top: 57%;
        background-color: white;
      }
    </style>
  </head>
  <body>
    <video playinsline autoplay muted id="cin1">
      <source src="./vid/1cin.mov" type="video/mp4" />
    </video>
    <div id="hintBook" onClick="hints()"></div>
    <img src="./img/indices.png" id="hints" />
    <video playinsline muted id="cin2">
      <source src="./vid/2cin.mp4" type="video/mp4" />
    </video>

    <div id="bypass" onClick="playVid()"></div>

    <div id="chest1"></div>
    <div id="chest2"></div>
    <div id="chest3"></div>
    <div id="chest4"></div>
    <div id="chest5"></div>
    <div id="chest6"></div>
    <div id="chest7"></div>
    <div id="chest8"></div>
    <div id="chest9"></div>
    <div id="chest10"></div>

    <script>
      document.addEventListener('keydown', keyboard);
      setTimeout(elimVid, 8000);
      function elimVid() {
        document.getElementById('cin1').style.display = 'none';
        findHints();
      }
      function findHints() {
        document.body.style.backgroundImage = 'url("./img/findHints.png")';
        document.getElementById('hintBook').style.display = 'flex';
      }
      function hints() {
        document.getElementById('hints').style.display = 'flex';
        setTimeout(invPath, 1000);
      }
      var pressedKey;

      function keyboard(e) {
        console.log(e.keyCode);
        if (e.keyCode == 87) {
          checkStep('w');
          console.log('W');
        }
        if (e.keyCode == 65) {
          checkStep('a');
          console.log('A');
        }
        if (e.keyCode == 68) {
          checkStep('d');
          console.log('D');
        }
      }
      var steps = [
        'w',
        'w',
        'w',
        'd',
        'w',
        'w',
        'w',
        'a',
        'w',
        'w',
        'd',
        'w',
        'a',
        'w',
        'w',
        'w',
        'a',
        'w',
        'd',
        'w',
      ];
      var currentStepIndex = 0;
      function invPath() {
        document.body.style.backgroundImage = 'url("./img/0.png")';
      }
      function checkStep(key) {
        if (key === steps[currentStepIndex]) {
          console.log('ok: ' + key);
          if (currentStepIndex <= steps.length) {
            currentStepIndex++;
            document.body.style.backgroundImage = `url(./img/${currentStepIndex}.png)`;
            if (currentStepIndex == steps.length) {
              document.getElementById('hints').style.display = 'none';
              setTimeout(playVid(), 500);
            }
          }
        } else {
          console.log('recommencer');

          document.body.style.backgroundImage = 'url("./img/inLava/1.png")';
          setTimeout(function () {
            document.body.style.backgroundImage = 'url("./img/inLava/2.png")';
          }, 200);
          setTimeout(function () {
            document.body.style.backgroundImage = 'url("./img/inLava/3.png")';
          }, 400);
          setTimeout(function () {
            document.body.style.backgroundImage = 'url("./img/inLava/4.png")';
          }, 600);
          setTimeout(function () {
            document.body.style.backgroundImage = 'url("./img/inLava/5.png")';
          }, 800);
          setTimeout(function () {
            document.body.style.backgroundImage = 'url("./img/inLava/6.png")';
          }, 1000);
          setTimeout(function () {
            document.body.style.backgroundImage = 'url("./img/inLava/7.png")';
          }, 1200);
          setTimeout(function () {
            document.body.style.backgroundImage = 'url("./img/inLava/8.png")';
          }, 1400);
          setTimeout(function () {
            document.body.style.backgroundImage = 'url("./img/inLava/9.png")';
          }, 1600);
          setTimeout(function () {
            document.body.style.backgroundImage = 'url("./img/inLava/10.png")';
          }, 1800);

          setTimeout(function () {
            document.body.style.backgroundImage = 'url("./img/0.png")';
          }, 2000);
          currentStepIndex = 0;
        }
      }
      var vid = document.getElementById('cin2');

      function playVid() {
        document.getElementById('cin2').style.display = 'flex';
        vid.play();
        console.log(vid);
        document.body.style.backgroundImage = 'url("./img/coffresMid.png")';
        setTimeout(function () {
          document.getElementById('cin2').style.display = 'none';
        }, 10000);
      }
      function changeChest() {
        if (key == 'a') {
          document.body.style.backgroundImage =
            'url("./img/coffresGauche.png")';
        }
        if (key == 'd') {
          document.body.style.backgroundImage =
            'url("./img/coffresDroite.png")';
        }
      }
    </script>
  </body>
</html>
